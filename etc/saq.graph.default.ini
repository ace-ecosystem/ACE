[config]
graph_local = etc/saq.graph.ini

[service_graph_resource_collector]
module = saq.collectors.graph_collections
#class = GraphResourceCollector
class = GraphResourceCollector
description = Microsoft Graph API Resource Collector - collect events described by Graph resource configs
enabled = yes

; how often to check for new alerts (in HH:MM:SS format)
query_frequency = 00:15:00
; when the collector first starts, how far back do you want to go to pull in the initial set of alerts? (in DD:HH:MM:SS format)
initial_range = 00:12:00:00
; when alerts are collected they can optionally be merged together by joining on a property
; this field specifies what property *of the alert* to merge on
; leave this empty to create a single alert for each bricata alert
merge_property = signature
resource_dirs = etc/graph_resource_configurations

; The Graph Collector exepects the following account to be completed:

;[graph_collection_account_default]
;tenant_id = uuid_from_o365
;authority_base_url = https://login.microsoftonline.com
;client_id = uuid_also_known_as_app_id
;scopes = https://graph.microsoft.com/.default
;thumbprint = certificate_thumbprint_as_defined_in_your_azure_ad_app
;private_key_file = path/to/private/key/file
; -- NOTE: If a client_credential (client secret) is supplied it will be used instead of
;    a supplied certificate when authenticating for tokens
;client_credential = encrypted:key_to_application_password_goes_here

; -- make sure the slash at the end of the endpoint is present or it can cause some weird
;    behavior
;endpoint = https://graph.microsoft.com/v1.0/users/

; -- Restrict this remediation account to a specific company, leave out of your config
; -- unless you know you need it.
;company_id =

; -- CA Cert --ex: if your requests are subject to SSL decryption.
;    These are separated as the auth endpoint is different than the
;    graph endpoint. Leave these items out of the config to verify
;    certs normally.
;auth_ca_cert_path = path/to/ca/cert/to/use/for/verification
;graph_ca_cert_path = path/to/ca/cert/to/use

; Graph API collection account examples
;



; Graph API remediation account example

;[remediation_account_email_unique_name]
;type = graph
;tenant_id = uuid_from_o365
;authority_base_url = https://login.microsoftonline.com
;client_id = uuid_also_known_as_app_id
;scopes = https://graph.microsoft.com/.default
;thumbprint = certificate_thumbprint_as_defined_in_your_azure_ad_app
;private_key_file = path/to/private/key/file
; -- NOTE: If a client_credential (client secret) is supplied it will be used instead of
;    a supplied certificate when authenticating for tokens
;client_credential = encrypted:key_to_application_password_goes_here

; -- make sure the slash at the end of the endpoint is present or it can cause some weird
;    behavior
;endpoint = https://graph.microsoft.com/v1.0/users/

; -- Restrict this remediation account to a specific company, leave out of your config
; -- unless you know you need it.
;company_id =

; -- CA Cert --ex: if your requests are subject to SSL decryption.
;    These are separated as the auth endpoint is different than the
;    graph endpoint. Leave these items out of the config to verify
;    certs normally.
;auth_ca_cert_path = path/to/ca/cert/to/use/for/verification
;graph_ca_cert_path = path/to/ca/cert/to/use
